<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>MorTeam</title>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:700,300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Exo+2:400,300,200' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="css/index.css" type="text/css">
  <link href="jbox/themes/TooltipDark.css" rel="stylesheet">
  <link href="jbox/jBox.css" rel="stylesheet">
  <script src="http://js.nicedit.com/nicEdit-latest.js" type="text/javascript"></script>
  <script type="text/javascript">
    bkLib.onDomLoaded(function() {
      new nicEditor({
          buttonList: ['bold', 'italic', 'underline', 'left', 'center', 'right', 'justify', 'removeformat', 'hr', 'upload']
      }).panelInstance('main_textarea');
    });
  </script>
  <script src="js/spin.js"></script>
  <script type="text/javascript">
      var loadingDiv = document.createElement("div");
      loadingDiv.className = "loading_circle";
      loadingDiv.id = "loading_circle";
  </script>
</head>

<body>
  <!-- <a href="/">home</a> | <a href="users">users</a> | <a href="subdivisions">subdivisions</a>

  <span id="logged-in-info" class="hidden">
    <a href="#" class="logout-btn">Log Out</a>
    <span class="user-display">Logged in as: <span id="username-display"></span></span>
  </span>
  <span id="logged-out-info" class="hidden">
    <a href="login">login</a>
  </span>

  <h2>This is the Home page</h2>
  <p>
    This is the beginning of something great. Ghost spam is free of politics.
  </p>
  <hr>
  <h2>Invited subdivisions</h2>
  <ul id="invited-subdivisions">
  </ul>
  <hr>
  <h2>Your subdivisions</h2>
  <ul id="your-subdivisions">
  </ul>
  <hr>
  <h2>List of public subdivisions</h2>
  <ul id="subdivisions-list">
  </ul> -->

  <div id="audio-files" style="display: none;">
    <audio id="click-sound">
        <source src="jbox/audio/bling2.wav" type="audio/wav" />
    </audio>
  </div>
  <!-- NAVIGATION BAR -->
  <div class="nav_dropdown">
    <p onclick="location='index'" style="background-color: orange">Home</p>
    <p onclick="location='chat'">Chat</p>
    <p onclick="location='drive'">Drive</p>
    <p onclick="location='cal'">Calendar</p>
    <p onclick="location='networks'">Networks</p>
  </div>
  <div class="navigation_bar">
      <ul id="navbar_list">
        <li class="navbar_item navbar_title navbar_title_index">
            MorTeam
        </li>
        <li class="navbar_item searchbox_list_item">
            <input type="text" placeholder="search" class="searchbox"></input>
            <div class="search_drop">
              <ul class="search_drop_items">
                <!-- <li>
                  under<br/>
                  construction
                </li>
                <li>
                  under<br/>
                  construction
                </li>
                <li>
                  under<br/>
                  construction
                </li>
                <li>
                  under<br/>
                  construction
                </li> -->
              </ul>
            </div>
        </li>
        <li class="navbar_item glyph_link chat_btn menu_btn" onclick="location='chat'">
            <span class="glyphicon glyphicon-comment"></span>
        </li>
        <li class="navbar_item glyph_link drive_btn menu_btn" onclick="location='drive'">
            <span class="glyphicon glyphicon-hdd"></span>
        </li>
        <li class="navbar_item glyph_link cal_btn menu_btn" onclick="location='cal'">
            <span class="glyphicon glyphicon-calendar"></span>
        </li>
        <li class="navbar_item glyph_link networks_btn menu_btn" onclick="location='networks'">
            <span class="glyphicon glyphicon-globe"></span>
        </li>
        <div class="navbar_item right_links">
          <li class="navbar_item glyph_link menu">
              <span class="glyphicon glyphicon-menu-hamburger"></span>
          </li>
          <li class="navbar_item glyph_link" id="notif_button">
              <span class="glyphicon glyphicon-inbox"></span>
              <span class="unseen_count bold">3</span>
          </li>
          <img class="profile_id" id="small_prof_pic" src="./images/user.jpg"></img>
          <span class="profile_name" id="name_link"></span>
        </div>
      </ul>
  </div>
  <!-- <div class="triangle_thing_notif hidden"></div>
  <div class="triangle_thing_prof hidden"></div> -->
  <div id="notif_drop" class="hidden">
      <ul>
          <li class="notif_list_item">hey</li>
          <li class="notif_list_item">hi</li>
          <li class="notif_list_item">ho</li>
      </ul>
  </div>
  <div id="prof_drop" class="hidden">
      <ul>
          <li class="notif_list_item" id="view_prof_button">View Profile and Settings</li>
          <li class="notif_list_item" id="logout_button">Log Out</li>
      </ul>
  </div>
  <div class="hidden" id="darken"></div>
  <!-- END OF NAVIGATION BAR -->
  <!-- BODY -->
  <div class="announcements_container" style="margin-top: 60px;">

      <div class="announcements_left">
        <p onclick="location='profile'">View Profile</p>
        <p id="logout_button">Log Out</p>
        <p id="team_button">MorTorq</p>
        <hr>
        <div id="your_subdivisions">
            <h5 style="margin-bottom: 15px;">Your Subdivisions</h5>
        </div>
        <hr>
        <div id="public_subdivisions">
            <h5 style="margin-bottom: 15px;">Public Subdivisions</h5>
        </div>
        <hr>
        <div id="invited_subdivisions">
            <h5 style="margin-bottom: 15px;">Subdivision Invites</h5>
        </div>
        <hr>
        <p class="new_pu_scope"><span class="glyphicon glyphicon-plus"></span> Make a Subdivision</p>
        <hr>
        <p id="aboutus_link">About Us</p>
        <span>Â© 2015 MorTeam</span>
      </div>
      <div class="announcements_center">
        <div class="post_announcement cf">
            <textarea class="announcement_textarea" id="main_textarea" placeholder="Make an announcement..."></textarea>
            <input type="button" class="announcement_post_button" value="Post"></input>
            <div class=" announcement_audience_button btn-group">
                <button class="button dropdown-toggle" data-toggle="dropdown"><span class="audience_selection">Everyone</span>
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu audience_drop">
                    <li class="audience_item selected first_audience">Everyone</li>
                    <li class="audience_item">Build</li>
                    <li class="audience_item">Programming</li>
                    <li class="audience_item">Business</li>
                    <li class="audience_item custom_audience"><span class="glyphicon glyphicon-cog"></span>&nbsp;Custom</li>
                </ul>
            </div>
        </div>
        <div class="announcements_list">
            <!-- <div class="announcement" data-postNum="1">
            <div class="announcement_top">
              <img id="medium_prof_pic" src="./images/user.jpg"></img>
              <span class="announcement_poster">Farbod Rafezy</span>
            </div>
            <span class="glyphicon glyphicon-remove delete_icon"></span><br>
            the words go here
          </div> -->
        </div>
      </div>
      <div class="announcements_right">
        <div class="ad" style="margin-top: 0px; position: fixed;"></div>
      </div>

  </div>


  <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script type="text/javascript" src="js/main.js"></script>
  <script>
  $(document).ready(function(){
    $.post("/f/getAllSubdivisionsForUserInTeam", function(responseText){
      var subdivisions = JSON.parse(responseText);
      if(subdivisions.length != 0){
        for (var i = 0; i < subdivisions.length; i++){
          var p = document.createElement("p");
          $(p).addClass("subdivision-link");
          $(p).attr("data-subdivisionid", subdivisions[i].id);
          var glyphSpan = "<span class='glyphicon glyphicon-screenshot'></span>"
          var nameSpan = document.createElement("span");
          $(nameSpan).html(" " + subdivisions[i].name);
          $(p).append(glyphSpan);
          $(p).append(nameSpan);
          $("#your_subdivisions").append( $(p) );
        }
      }else{
        $("#your_subdivisions").append( "none" );
      }
    });
    $.post("/f/getPublicSubdivisions", {team_id: localStorage.c_team}, function(responseText){
      var subdivisions = JSON.parse(responseText);
      if(subdivisions.length != 0){
        for(var i = 0 ; i < subdivisions.length; i++){
          // var li = document.createElement("li");
          // li.innerHTML = subdivisions[i].name;
          // $(li).attr("data-subdivisionid", subdivisions[i].id);
          // $(li).addClass("subdivision-link");
          // $("#subdivisions-list").append(li);
          var p = document.createElement("p");
          $(p).addClass("subdivision-link");
          $(p).attr("data-subdivisionid", subdivisions[i].id);
          var glyphSpan = "<span class='glyphicon glyphicon-screenshot'></span>"
          var nameSpan = document.createElement("span");
          $(nameSpan).html(" " + subdivisions[i].name);
          $(p).append(glyphSpan);
          $(p).append(nameSpan);
          $("#public_subdivisions").append( $(p) );

        }
      }else{
        $("#public_subdivisions").append( "none" );
      }
    });
    $.post("/f/loadSubdivisionInvitations", {team_id: localStorage.c_team}, function(responseText){
      var invites = JSON.parse(responseText);
      if(invites.length != 0){
        for (var i = 0; i < invites.length; i++){
          // var li = document.createElement("li");
          // li.innerHTML = invites[i].name;
          // li.innerHTML += "<input type='button' value='accept' class='accept-invite' />"
          // $(li).attr("data-subdivisionid", invites[i].id);
          // $("#invited-subdivisions").append( $(li) );

          var p = document.createElement("p");
          $(p).addClass("subdivision-invite");
          $(p).attr("data-subdivisionid", invites[i].id);
          var glyphSpan = "<span class='glyphicon glyphicon-screenshot'></span>"
          var nameSpan = document.createElement("span");
          $(nameSpan).html(" " + invites[i].name);
          $(p).append(glyphSpan);
          $(p).append(nameSpan);
          $("#invited_subdivisions").append( $(p) );
        }
      }else{
        $("#invited_subdivisions").append( "none" );
      }
    });

    $(document).on("click", ".accept-invite", function(){
      var subdivision_id = $(this).parent().attr("data-subdivisionid");
      var invite = $(this).parent();
      $.post("/f/acceptSubdivisionInvitation", {subdivision_id: subdivision_id}, function(responseText){
        console.log(responseText);
        if(responseText == "success"){
          invite.remove();
        }
      })
    });
    $(document).on("click", ".subdivision-link", function(){
      location = "/s/" + $(this).attr("data-subdivisionid");
    });

  });
  </script>
</body>

</html>
